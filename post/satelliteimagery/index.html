<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="David D. Hofmann">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="/img/backgrounds/Satellite.jpg">
    <meta property="twitter:image" content="/img/backgrounds/Satellite.jpg" />
    

    
    <meta name="title" content="Download and Visualize Satellite Images in R" />
    <meta property="og:title" content="Download and Visualize Satellite Images in R" />
    <meta property="twitter:title" content="Download and Visualize Satellite Images in R" />
    

    
    <meta name="description" content="David D. Hofmann&#39;s Personal Website">
    <meta property="og:description" content="David D. Hofmann&#39;s Personal Website" />
    <meta property="twitter:description" content="David D. Hofmann&#39;s Personal Website" />
    

    
    <meta property="twitter:card" content="When you visualize spatial data on a map, it is often useful to plot a satellite image in the background. Hence, I would like to show you can use R to access and download satellite imagery that is free of charge. Once downloaded, we will plot the imagery using either base plot, ggplot, or the magnificent tmap package." />
    
    

    <meta name="keyword"  content="David Hofmann, Blog, PhD Student, Ecology, University of Zurich, R, Movement Ecology, Botany">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Download and Visualize Satellite Images in R | David D. Hofmann | UZH</title>

    <link rel="canonical" href="/post/satelliteimagery/">

    
    
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hugo-theme-cleanwhite.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link rel="stylesheet" href="/css/font-awesome.all.min.css">

    
    

    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    <script src="/js/lazysizes.min.js"></script>

    
    

</head>






<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">David D. Hofmann</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">All Posts</a>
                    </li>
                    
                    
		    
                        <li><a href="/about//">ABOUT</a></li>
                    
                        <li><a href="/publications//">PUBLICATIONS</a></li>
                    
                        <li><a href="/gallery//">GALLERY</a></li>
                    
                        <li><a href="/animals//">ANIMALS</a></li>
                    
		            <li>
                        <a href="/search"><i class="fa fa-search"></i></a>
		           </li>
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/backgrounds/Satellite.jpg')
    }
</style>

<header class="intro-header" >

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/r" title="R">
                            R
                        </a>
                        
                        <a class="tag" href="/tags/spatial" title="spatial">
                            spatial
                        </a>
                        
                        <a class="tag" href="/tags/satellite" title="satellite">
                            satellite
                        </a>
                        
                    </div>
                    <h1>Download and Visualize Satellite Images in R</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        
                            Posted by 
                            
                                David D. Hofmann
                             
                            on 
                            Friday, December 31, 2021
                            
                            
                            
                            
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                
<script src="http://localhost:1313/post/satelliteimagery/index_files/accessible-code-block/empty-anchor.js"></script>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#downloading-satellite-imagery">Downloading Satellite Imagery</a></li>
<li><a href="#plotting-the-downloaded-imagery">Plotting the Downloaded Imagery</a>
<ul>
<li><a href="#using-base-plot">Using Base Plot</a></li>
<li><a href="#using-ggplot">Using Ggplot</a></li>
<li><a href="#using-tmap">Using Tmap</a></li>
</ul></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#session-information">Session Information</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>When you visualize spatial data on a map, it is often useful to plot a satellite
image in the background. Unfortunately, satellite data is incredibly expensive
to produce, and so not every provider of corresponding data is willing to
provide free access to it. Google, for instance, pays a lot of money to get
access to satellite data of third parties, which it can then display on <a href="https://www.google.com/maps">Google
Maps</a> or <a href="https://www.google.com/intl/en/earth/">Google
Earth</a>. Consequently, you can only access
its data using an API for which you potentially need to pay. Luckily, there are
still other providers that grant access to satellite imagery for free. Hence, in
today’s blog post, I would like to show you can access and download satellite
imagery that is free of charge within R. Once downloaded, we will also learn how
to plot the downloaded imagery using either base plot, ggplot, or the
magnificent tmap package.</p>
</div>
<div id="downloading-satellite-imagery" class="section level1">
<h1>Downloading Satellite Imagery</h1>
<p>Let’s assume that we want to visualize the study area of a research project that
is located in the Swiss Alps on a satellite map. The area is given by the
following rectangle:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># Load required packages for this blog post</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(raster)          <span class="co"># For handling spatial data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(tmaptools)       <span class="co"># To download satellite imagery</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">library</span>(GISTools)        <span class="co"># To add north arrow to a base plot</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)         <span class="co"># To plot using the ggplot engine</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="kw">library</span>(sf)              <span class="co"># To plot spatial objects with ggplot</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="kw">library</span>(ggspatial)       <span class="co"># To add north arrow and scale bars to a ggplot</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="kw">library</span>(tmap)            <span class="co"># To plot using tmap</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="co"># Rectangular polygon that delineates our study area</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>study_area &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">extent</span>(<span class="kw">c</span>(<span class="dv">2762710</span>, <span class="dv">2762905</span>, <span class="dv">1184919</span>, <span class="dv">1185332</span>)), <span class="st">&quot;SpatialPolygons&quot;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="kw">crs</span>(study_area) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+init=epsg:2056&quot;</span>)</span></code></pre></div>
<p>We could now download satellite data for this region. However, I usually prefer
to download data on a slightly larger extent so that some of the surroundings of
the study area can also be included in the plot. Hence, let’s define an area of
interest (aoi) for which we want to download satellite data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Define an area of interest (aoi)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>aoi &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">extent</span>(<span class="kw">c</span>(<span class="dv">2762179</span>, <span class="dv">2763727</span>, <span class="dv">1184568</span>, <span class="dv">1185640</span>)), <span class="st">&quot;SpatialPolygons&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="kw">crs</span>(aoi) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+init=epsg:2056&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co"># Let&#39;s plot the study area and the area of interest together</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="kw">plot</span>(aoi, <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="kw">plot</span>(study_area, <span class="dt">add =</span> T, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">col =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;red&quot;</span>, <span class="dt">alpha.f =</span> <span class="fl">0.2</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>)</span></code></pre></div>
<p><img src="http://localhost:1313/post/satelliteimagery/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Neat! Now it’s time to download satellite data for the aoi. The package that
we’re going to use for this is called <code>tmaptools</code> (which in the background uses
the package <code>OpenStreetMap</code>). Instead of relying on satellite data provided
through Google, this package allows us to access satellite imagery from Bing
using the function <code>read_osm()</code> (in fact, you could access data for many other
providers too). The cool thing is that Bing enables us to download satellite
imagery at really high resolution. In fact, we can control the resolution of the
downloaded data by adjusting the <code>zoom</code> arguement. Let’s give it a try and
download some satellite data for our aoi.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Download satellite data for the aoi (control resolution of the data using the</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co"># &quot;zoom&quot; argument. The higher the number, the better the resolution but the</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co"># longer the download will take)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>sat &lt;-<span class="st"> </span><span class="kw">read_osm</span>(aoi, <span class="dt">type =</span> <span class="st">&quot;bing&quot;</span>, <span class="dt">zoom =</span> <span class="dv">17</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co"># Check what we downloaded</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="kw">class</span>(sat)</span></code></pre></div>
<pre><code>## [1] &quot;stars&quot;</code></pre>
<p>The downloaded object is of the class “stars”. I don’t really like this format,
so we’ll convert it to a regular raster-stack from the <code>raster</code> package. We will
also reproject the stack to the local <a href="https://epsg.io/2056">LV-95</a> projection.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Convert the downloaded satellite data to a rasterstack</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>sat &lt;-<span class="st"> </span><span class="kw">as</span>(sat, <span class="st">&quot;Raster&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co"># Reproject the data to the correct CRS using the &quot;nearest neighbor&quot; (ngb)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="co"># method</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>sat &lt;-<span class="st"> </span><span class="kw">projectRaster</span>(sat, <span class="dt">crs =</span> <span class="kw">CRS</span>(<span class="st">&quot;+init=epsg:2056&quot;</span>), <span class="dt">method =</span> <span class="st">&quot;ngb&quot;</span>)</span></code></pre></div>
<p>The resulting raster-stack contains three raster layers, together forming an RGB
image (band 1 = red, band 2 = green, band 3 = blue). Let’s take a look at each
of the bands and plot them.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Visualize the three layers</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">plot</span>(sat, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span><span class="op">/</span><span class="dv">100</span>))</span></code></pre></div>
<p><img src="http://localhost:1313/post/satelliteimagery/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>As you can see, the layers are not perfectly aligned horizontally. This is
because we reprojected the data to the local LV-95 projection. To make sure
everything is perfectly aligned, we can crop the bands to our aoi.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># Crop the layers to the aoi</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>sat &lt;-<span class="st"> </span><span class="kw">crop</span>(sat, aoi)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="co"># Plot them again</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="kw">plot</span>(sat, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span><span class="op">/</span><span class="dv">100</span>), <span class="dt">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="http://localhost:1313/post/satelliteimagery/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="plotting-the-downloaded-imagery" class="section level1">
<h1>Plotting the Downloaded Imagery</h1>
<p>Obvously we don’t want to plot the bands separately but want to combine them
into a single RGB image. Here, I’ll show you how to achieve this using three
different plotting engines.</p>
<div id="using-base-plot" class="section level2">
<h2>Using Base Plot</h2>
<p>With R’s base plot we can plot RGB rasterlayers using the <code>plotRGB()</code> command.
This function takes the rasterstack and combines the layers into a color-image.
To make the plot look more professional and give some spatial reference, we can
also add a north arrow and a scale bar to the final image.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Visualize the satellite image using R&#39;s base plot</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">plotRGB</span>(sat, <span class="dt">r =</span> <span class="dv">1</span>, <span class="dt">g =</span> <span class="dv">2</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">axes =</span> F)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="kw">plot</span>(study_area, <span class="dt">add =</span> T, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">col =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;red&quot;</span>, <span class="dt">alpha.f =</span> <span class="fl">0.2</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="kw">north.arrow</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>    <span class="dt">xb     =</span> <span class="kw">xmin</span>(sat) <span class="op">+</span><span class="st"> </span><span class="dv">150</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>  , <span class="dt">yb     =</span> <span class="kw">ymin</span>(sat) <span class="op">+</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>  , <span class="dt">len    =</span> <span class="dv">25</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>  , <span class="dt">col    =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>  , <span class="dt">border =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>  , <span class="dt">tcol   =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a><span class="kw">scalebar</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>    <span class="dt">type  =</span> <span class="st">&quot;bar&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a>  , <span class="dt">xy    =</span> <span class="kw">c</span>(<span class="kw">xmax</span>(sat) <span class="op">-</span><span class="st"> </span><span class="dv">450</span> , <span class="kw">ymin</span>(sat) <span class="op">+</span><span class="st"> </span><span class="dv">60</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a>  , <span class="dt">d     =</span> <span class="dv">400</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a>  , <span class="dt">divs  =</span> <span class="dv">4</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a>  , <span class="dt">below =</span> <span class="st">&quot;meters&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a>  , <span class="dt">col   =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a>)</span></code></pre></div>
<p><img src="http://localhost:1313/post/satelliteimagery/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="using-ggplot" class="section level2">
<h2>Using Ggplot</h2>
<p>We can also plot our satellite data using the <code>ggplot2</code> package. However,
instead of plotting the raster-stack directly, we first need to convert the
layers into a regular dataframe. This can easily be done using the
<code>as.data.frame()</code> function. Note that we specify <code>xy = T</code> to ensure that the
coordinates of each pixel in the rasters are retained.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># Convert the rasterstack to a regular dataframe</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(sat, <span class="dt">xy =</span> T)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##         x       y red green blue
## 1 2762180 1185540  95    95   67
## 2 2762180 1185540  95    95   67
## 3 2762181 1185540  95    95   67
## 4 2762182 1185540  95    95   67
## 5 2762183 1185540  94    94   66
## 6 2762184 1185540  91    94   65</code></pre>
<p>We can then map the rgb values of each coordinate in ggplot as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co"># Visualize the satellite image using ggplot</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> <span class="kw">rgb</span>(red, green, blue, <span class="dt">maxColorValue =</span> <span class="dv">255</span>))) <span class="op">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_fill_identity</span>() <span class="op">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">coord_sf</span>() <span class="op">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a><span class="st">  </span><span class="co"># Study area</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_sf</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>      <span class="dt">data        =</span> <span class="kw">st_as_sf</span>(study_area)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>    , <span class="dt">inherit.aes =</span> F</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>    , <span class="dt">col         =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>    , <span class="dt">fill        =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>    , <span class="dt">alpha       =</span> <span class="fl">0.2</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>  ) <span class="op">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a><span class="st">  </span><span class="co"># North arrow</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a><span class="st">  </span><span class="kw">annotation_north_arrow</span>(</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>      <span class="dt">location =</span> <span class="st">&quot;bl&quot;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>    , <span class="dt">pad_x    =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>    , <span class="dt">pad_y    =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>    , <span class="dt">style    =</span> <span class="kw">north_arrow_fancy_orienteering</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a>          <span class="dt">fill      =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a>        , <span class="dt">line_col  =</span> <span class="ot">NA</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>        , <span class="dt">text_col  =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a>        , <span class="dt">text_size =</span> <span class="dv">12</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a>      )</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a>  ) <span class="op">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true"></a><span class="st">  </span><span class="co"># Scalebar</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true"></a><span class="st">  </span><span class="kw">annotation_scale</span>(</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true"></a>      <span class="dt">location =</span> <span class="st">&quot;br&quot;</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true"></a>    , <span class="dt">pad_x    =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true"></a>    , <span class="dt">pad_y    =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true"></a>    , <span class="dt">text_col =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true"></a>  )</span></code></pre></div>
<p><img src="http://localhost:1313/post/satelliteimagery/index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="using-tmap" class="section level2">
<h2>Using Tmap</h2>
<p>One of my favorite packages to create pretty maps is called <code>tmap</code>. The syntax
of tmap is a bit unusual and takes some time to get used to but once learned,
tmap is a really powerful mapping tool. If you are not familiar with the
package, it is definitely worth checking out its
<a href="https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html">vignette</a>.
Anyways, let’s plot our satellite imagery with tmap using the <code>tm_shape()</code> and
<code>tm_rgb()</code> functions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># Visualize the satellite image using tmap</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">tm_shape</span>(sat) <span class="op">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">tm_rgb</span>() <span class="op">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="st">  </span><span class="co"># Study area</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_shape</span>(study_area) <span class="op">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">border.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">border.alpha =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a><span class="st">  </span><span class="co"># North arrow</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_compass</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>      <span class="dt">position   =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>    , <span class="dt">text.color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>    , <span class="dt">color.dark =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>  ) <span class="op">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a><span class="st">  </span><span class="co"># Scalebar</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_scale_bar</span>(</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a>      <span class="dt">position   =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a>    , <span class="dt">text.color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>  ) <span class="op">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_graticules</span>(<span class="dt">lines =</span> F)</span></code></pre></div>
<p><img src="http://localhost:1313/post/satelliteimagery/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this blog post we learned a relatively simple approach to download and
visualize free satellite imagery from Microsoft Bing using R.</p>
</div>
<div id="session-information" class="section level1">
<h1>Session Information</h1>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Linux Mint 21.3
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0
## 
## locale:
##  [1] LC_CTYPE=de_CH.UTF-8          LC_NUMERIC=C                 
##  [3] LC_TIME=de_CH.UTF-8           LC_COLLATE=de_CH.UTF-8       
##  [5] LC_MONETARY=de_CH.UTF-8       LC_MESSAGES=de_CH.UTF-8      
##  [7] LC_PAPER=de_CH.UTF-8          LC_NAME=de_CH.UTF-8          
##  [9] LC_ADDRESS=de_CH.UTF-8        LC_TELEPHONE=de_CH.UTF-8     
## [11] LC_MEASUREMENT=de_CH.UTF-8    LC_IDENTIFICATION=de_CH.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tmap_3.3-3         ggspatial_1.1.9    sf_1.0-13          ggplot2_3.4.4     
##  [5] GISTools_0.7-4     rgeos_0.6-3        MASS_7.3-55        RColorBrewer_1.1-3
##  [9] maptools_1.1-7     tmaptools_3.1-1    raster_3.6-20      sp_1.6-1          
## 
## loaded via a namespace (and not attached):
##  [1] sass_0.4.6          jsonlite_1.8.5      viridisLite_0.4.2  
##  [4] bslib_0.5.0         highr_0.10          yaml_2.3.7         
##  [7] OpenStreetMap_0.3.4 pillar_1.9.0        lattice_0.20-45    
## [10] glue_1.6.2          digest_0.6.31       colorspace_2.1-0   
## [13] htmltools_0.5.5     XML_3.99-0.14       pkgconfig_2.0.3    
## [16] stars_0.6-1         s2_1.1.4            bookdown_0.34      
## [19] scales_1.2.1        terra_1.7-74        tibble_3.2.1       
## [22] proxy_0.4-27        generics_0.1.3      farver_2.1.1       
## [25] cachem_1.0.8        withr_2.5.2         leafsync_0.1.0     
## [28] cli_3.6.1           magrittr_2.0.3      evaluate_0.21      
## [31] fansi_1.0.5         lwgeom_0.2-13       foreign_0.8-82     
## [34] class_7.3-20        blogdown_1.17       tools_4.1.2        
## [37] lifecycle_1.0.4     munsell_0.5.0       compiler_4.1.2     
## [40] jquerylib_0.1.4     e1071_1.7-13        rlang_1.1.2        
## [43] classInt_0.4-9      units_0.8-2         grid_4.1.2         
## [46] dichromat_2.0-0.1   htmlwidgets_1.6.2   crosstalk_1.2.0    
## [49] leafem_0.2.0        base64enc_0.1-3     rmarkdown_2.22     
## [52] wk_0.7.3            gtable_0.3.3        codetools_0.2-18   
## [55] abind_1.4-5         DBI_1.1.3           R6_2.5.1           
## [58] knitr_1.43          dplyr_1.1.3         rgdal_1.6-6        
## [61] fastmap_1.1.1       utf8_1.2.4          KernSmooth_2.23-20 
## [64] rJava_1.0-6         parallel_4.1.2      Rcpp_1.0.11        
## [67] vctrs_0.6.4         png_0.1-8           leaflet_2.2.0.9000 
## [70] tidyselect_1.2.0    xfun_0.39</code></pre>
</div>


                

                
                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/scaling/" data-toggle="tooltip" data-placement="top" title="Some Insights on Scaling/Standardizing">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/hiddenmarkovmodel/" data-toggle="tooltip" data-placement="top" title="A Simulation-Based Introduction to Hidden-Markov Movement Models">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>
                

                



            </div>

            
            

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                

                
                
            </div>
        </div>
    </div>
</article>




<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script async src="//yihui.org/js/center-img.js"></script>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">                  
                    
                    <li>
                        <a href="mailto:daviddenishofmann@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		           
                    
                    <li>
                        <a href="https://twitter.com/daviddhofmann">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    

		            
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/DavidDHofmann">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		            
                    
                    
                    
                    
                    
                    
                    
                    
                    
            
            
            
           
             </ul>
		<p class="copyright text-muted">
                    Copyright &copy; David D. Hofmann 2025
                    
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function loadAsync(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        loadAsync("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>











</body>
</html>
